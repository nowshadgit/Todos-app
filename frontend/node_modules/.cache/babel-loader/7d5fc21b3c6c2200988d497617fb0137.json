{"ast":null,"code":"import _defineProperty from \"/home/nowshad/Desktop/Company Projects/footprints/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/nowshad/Desktop/Company Projects/footprints/frontend/src/containers/AddEditOrgUnits/AddEditOrgUnits.jsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport PageHeader from '../../components/PageHeader/PageHeader';\nimport pageConfig from '../../utils/pageConfig';\nimport { getActionsFormate } from '../../utils/common';\nimport AddEditOrgUnitsForm from '../../components/AddEditOrgUnitsForm/AddEditOrgUnitsForm';\nimport ACTIONS from '../../apiConfig/actions.constants';\nimport { getErrorResMsg } from '../../utils/formValidations';\nimport { PAGE, STORE } from '../../utils/constants';\nimport PageLoader from '../../components/PageLoader/PageLoader';\n\nclass AddEditOrgUnits extends React.Component {\n  constructor(props) {\n    super(props);\n    this.ORG_UNIT_FIELD_ID = 'org-unit-name';\n    this.PARENT_FIELD_ID = 'parent-field';\n    this.SELECTED_PARENT_ID = 'selected-parent';\n\n    this.enableSubmit = orgUnitName => {\n      const disabled = !(orgUnitName.length > 0);\n\n      if (this.props.errorCode) {\n        const type = ACTIONS.ORG_UNITS.RESET_STATE;\n        this.props.resetState(type);\n        this.setState({\n          errorCode: ''\n        });\n      }\n\n      this.setState({\n        disabled\n      });\n    };\n\n    this.handleChange = event => {\n      this.setState({\n        [event.target.id]: event.target.value,\n        formErrors: {}\n      }, () => this.enableSubmit(this.state[this.ORG_UNIT_FIELD_ID]));\n    };\n\n    this.handleParents = (currentNode, selectedNodes) => {\n      if (currentNode.checked && currentNode.orgUnitId) {\n        this.setState({\n          [this.PARENT_FIELD_ID]: currentNode.orgUnitId,\n          formErrors: {}\n        }, () => this.enableSubmit(this.state[this.ORG_UNIT_FIELD_ID], this.state[this.PARENT_FIELD_ID]));\n      } else {\n        this.setState({\n          [this.PARENT_FIELD_ID]: '',\n          formErrors: {}\n        }, () => this.enableSubmit(this.state[this.ORG_UNIT_FIELD_ID], this.state[this.PARENT_FIELD_ID]));\n      }\n    };\n\n    this.handleSubmit = event => {\n      event.preventDefault();\n      let data = {};\n\n      if (this.state[this.PARENT_FIELD_ID]) {\n        data = {\n          name: this.state[this.ORG_UNIT_FIELD_ID],\n          parent: this.state[this.PARENT_FIELD_ID]\n        };\n      } else {\n        data = {\n          name: this.state[this.ORG_UNIT_FIELD_ID]\n        };\n      }\n\n      const type = pageConfig[this.props.page].actions.postData;\n      this.props.submit(type, {\n        data,\n        props: _objectSpread({}, this.props)\n      });\n    };\n\n    this.state = {\n      formErrors: {},\n      formValidity: false,\n      [this.ORG_UNIT_FIELD_ID]: '',\n      [this.PARENT_FIELD_ID]: '',\n      errorCode: '',\n      disabled: true,\n      data: [],\n      dropdownMode: 'radioSelect',\n      [this.SELECTED_PARENT_ID]: [],\n      firstRender: true\n    };\n  }\n\n  componentDidMount() {\n    const _this$props = this.props,\n          page = _this$props.page,\n          getOrgUnitDetails = _this$props.getOrgUnitDetails,\n          match = _this$props.match;\n    const utype = pageConfig[page].actions.fetchOrgUnitInfo;\n\n    if (utype) {\n      const params = match.params;\n      getOrgUnitDetails(utype, _objectSpread({}, params, {\n        page\n      }));\n    }\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    const errorCode = nextProps.errorCode;\n\n    if (errorCode && errorCode !== prevState.errorCode) {\n      const errMsg = getErrorResMsg(errorCode, PAGE.ADD_ORG_UNIT);\n      return {\n        formErrors: errMsg,\n        errorCode\n      };\n    }\n\n    if (nextProps.page === PAGE.UPDATE_ORG_UNIT && nextProps.orgUnitDetails && Object.values(nextProps.orgUnitDetails).length > 0 && prevState.firstRender) {\n      const _nextProps$orgUnitDet = nextProps.orgUnitDetails,\n            name = _nextProps$orgUnitDet.name,\n            parent = _nextProps$orgUnitDet.parent;\n      const valExist = parent && Object.values(parent).length > 0;\n      return {\n        'org-unit-name': name,\n        'selected-parent': valExist ? [parent] : [],\n        'parent-field': valExist ? parent.id : '',\n        disabled: !(valExist && name),\n        firstRender: false\n      };\n    }\n\n    return prevState;\n  }\n\n  render() {\n    const _this$props2 = this.props,\n          page = _this$props2.page,\n          inProgress = _this$props2.inProgress;\n    const pageTitle = pageConfig[page].pageTitle;\n    const showPageLoader = inProgress && this.state.disabled && page === PAGE.UPDATE_ORG_UNIT;\n    return React.createElement(\"div\", {\n      className: \"add-edit-user\",\n      id: \"add-edit-org-unit-page\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(PageLoader, {\n      inProgress: showPageLoader,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }), React.createElement(PageHeader, {\n      title: pageTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }), React.createElement(AddEditOrgUnitsForm, {\n      handleSubmit: this.handleSubmit,\n      formErrors: this.state.formErrors,\n      orgUnitFieldId: this.ORG_UNIT_FIELD_ID,\n      orgUnitFieldValue: this.state[this.ORG_UNIT_FIELD_ID],\n      handleParents: this.handleParents,\n      parentFieldIds: this.PARENT_FIELD_ID,\n      handleChange: this.handleChange,\n      disabled: this.state.disabled,\n      page: page,\n      mode: this.state.dropdownMode,\n      prevPrentOrgUnit: this.state[this.SELECTED_PARENT_ID],\n      inProgress: inProgress,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }));\n  }\n\n}\n\nAddEditOrgUnits.propTypes = {\n  page: PropTypes.string.isRequired,\n  submit: PropTypes.func.isRequired,\n  errorCode: PropTypes.string.isRequired,\n  resetState: PropTypes.func.isRequired,\n  getOrgUnitDetails: PropTypes.func.isRequired,\n  match: PropTypes.object.isRequired,\n  orgUnitDetails: PropTypes.object.isRequired,\n  inProgress: PropTypes.bool.isRequired\n};\nAddEditOrgUnits.defaultProps = {};\n\nconst mapStateToProps = state => {\n  return {\n    errorCode: state.addEditOrgUnitReducerStore.errorCode,\n    orgUnitDetails: state.listReducerStore[STORE.ORG_UNITS_DETAILS],\n    inProgress: state.addEditOrgUnitReducerStore.inProgress\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    submit: (type, data) => {\n      dispatch(getActionsFormate(type, data));\n    },\n    resetState: type => {\n      dispatch(getActionsFormate(type));\n    },\n    getOrgUnitDetails: (type, data) => {\n      dispatch(getActionsFormate(type, data));\n    }\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(AddEditOrgUnits));","map":{"version":3,"sources":["/home/nowshad/Desktop/Company Projects/footprints/frontend/src/containers/AddEditOrgUnits/AddEditOrgUnits.jsx"],"names":["React","connect","withRouter","PropTypes","PageHeader","pageConfig","getActionsFormate","AddEditOrgUnitsForm","ACTIONS","getErrorResMsg","PAGE","STORE","PageLoader","AddEditOrgUnits","Component","constructor","props","ORG_UNIT_FIELD_ID","PARENT_FIELD_ID","SELECTED_PARENT_ID","enableSubmit","orgUnitName","disabled","length","errorCode","type","ORG_UNITS","RESET_STATE","resetState","setState","handleChange","event","target","id","value","formErrors","state","handleParents","currentNode","selectedNodes","checked","orgUnitId","handleSubmit","preventDefault","data","name","parent","page","actions","postData","submit","formValidity","dropdownMode","firstRender","componentDidMount","getOrgUnitDetails","match","utype","fetchOrgUnitInfo","params","getDerivedStateFromProps","nextProps","prevState","errMsg","ADD_ORG_UNIT","UPDATE_ORG_UNIT","orgUnitDetails","Object","values","valExist","render","inProgress","pageTitle","showPageLoader","propTypes","string","isRequired","func","object","bool","defaultProps","mapStateToProps","addEditOrgUnitReducerStore","listReducerStore","ORG_UNITS_DETAILS","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport PageHeader from '../../components/PageHeader/PageHeader';\nimport pageConfig from '../../utils/pageConfig';\nimport { getActionsFormate } from '../../utils/common';\nimport AddEditOrgUnitsForm from '../../components/AddEditOrgUnitsForm/AddEditOrgUnitsForm';\nimport ACTIONS from '../../apiConfig/actions.constants';\nimport { getErrorResMsg } from '../../utils/formValidations';\nimport { PAGE, STORE } from '../../utils/constants';\nimport PageLoader from '../../components/PageLoader/PageLoader';\n\nclass AddEditOrgUnits extends React.Component {\n  ORG_UNIT_FIELD_ID = 'org-unit-name';\n\n  PARENT_FIELD_ID = 'parent-field';\n\n  SELECTED_PARENT_ID = 'selected-parent';\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      formErrors: {},\n      formValidity: false,\n      [this.ORG_UNIT_FIELD_ID]: '',\n      [this.PARENT_FIELD_ID]: '',\n      errorCode: '',\n      disabled: true,\n      data: [],\n      dropdownMode: 'radioSelect',\n      [this.SELECTED_PARENT_ID]: [],\n      firstRender: true\n    };\n  }\n\n  componentDidMount() {\n    const { page, getOrgUnitDetails, match } = this.props;\n    const utype = pageConfig[page].actions.fetchOrgUnitInfo;\n    if (utype) {\n      const { params } = match;\n      getOrgUnitDetails(utype, { ...params, page });\n    }\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    const { errorCode } = nextProps;\n    if (errorCode && errorCode !== prevState.errorCode) {\n      const errMsg = getErrorResMsg(errorCode, PAGE.ADD_ORG_UNIT);\n      return { formErrors: errMsg, errorCode };\n    }\n    if (\n      nextProps.page === PAGE.UPDATE_ORG_UNIT &&\n      nextProps.orgUnitDetails &&\n      Object.values(nextProps.orgUnitDetails).length > 0 &&\n      prevState.firstRender\n    ) {\n      const { name, parent } = nextProps.orgUnitDetails;\n      const valExist = parent && Object.values(parent).length > 0;\n      return {\n        'org-unit-name': name,\n        'selected-parent': valExist ? [parent] : [],\n        'parent-field': valExist ? parent.id : '',\n        disabled: !(valExist && name),\n        firstRender: false\n      };\n    }\n    return prevState;\n  }\n\n  enableSubmit = (orgUnitName) => {\n    const disabled = !(orgUnitName.length > 0);\n    if (this.props.errorCode) {\n      const type = ACTIONS.ORG_UNITS.RESET_STATE;\n      this.props.resetState(type);\n      this.setState({ errorCode: '' });\n    }\n    this.setState({ disabled });\n  };\n\n  handleChange = event => {\n    this.setState(\n      {\n        [event.target.id]: event.target.value,\n        formErrors: {}\n      },\n      () =>\n        this.enableSubmit(\n          this.state[this.ORG_UNIT_FIELD_ID],\n        )\n    );\n  };\n\n  handleParents = (currentNode, selectedNodes) => {\n    if (currentNode.checked && currentNode.orgUnitId) {\n      this.setState(\n        {\n          [this.PARENT_FIELD_ID]: currentNode.orgUnitId,\n          formErrors: {}\n        },\n        () =>\n          this.enableSubmit(\n            this.state[this.ORG_UNIT_FIELD_ID],\n            this.state[this.PARENT_FIELD_ID]\n          )\n      );\n    } else {\n      this.setState(\n        {\n          [this.PARENT_FIELD_ID]: '',\n          formErrors: {}\n        },\n        () =>\n          this.enableSubmit(\n            this.state[this.ORG_UNIT_FIELD_ID],\n            this.state[this.PARENT_FIELD_ID]\n          )\n      );\n    }\n  };\n\n  handleSubmit = event => {\n    event.preventDefault();\n\n    let data = {};\n      \n    if(this.state[this.PARENT_FIELD_ID]){\n      data = {\n        name: this.state[this.ORG_UNIT_FIELD_ID],\n        parent: this.state[this.PARENT_FIELD_ID]\n      };\n    }else{\n      data = {\n        name: this.state[this.ORG_UNIT_FIELD_ID],\n      };\n    }\n    const type = pageConfig[this.props.page].actions.postData;\n    this.props.submit(type, { data, props: { ...this.props } });\n  };\n\n  render() {\n    const { page, inProgress } = this.props;\n    const { pageTitle } = pageConfig[page];\n    const showPageLoader =\n      inProgress && this.state.disabled && page === PAGE.UPDATE_ORG_UNIT;\n    return (\n      <div className=\"add-edit-user\" id=\"add-edit-org-unit-page\">\n        <PageLoader inProgress={showPageLoader} />\n        <PageHeader title={pageTitle} />\n        <AddEditOrgUnitsForm\n          handleSubmit={this.handleSubmit}\n          formErrors={this.state.formErrors}\n          orgUnitFieldId={this.ORG_UNIT_FIELD_ID}\n          orgUnitFieldValue={this.state[this.ORG_UNIT_FIELD_ID]}\n          handleParents={this.handleParents}\n          parentFieldIds={this.PARENT_FIELD_ID}\n          handleChange={this.handleChange}\n          disabled={this.state.disabled}\n          page={page}\n          mode={this.state.dropdownMode}\n          prevPrentOrgUnit={this.state[this.SELECTED_PARENT_ID]}\n          inProgress={inProgress}\n        />\n      </div>\n    );\n  }\n}\n\nAddEditOrgUnits.propTypes = {\n  page: PropTypes.string.isRequired,\n  submit: PropTypes.func.isRequired,\n  errorCode: PropTypes.string.isRequired,\n  resetState: PropTypes.func.isRequired,\n  getOrgUnitDetails: PropTypes.func.isRequired,\n  match: PropTypes.object.isRequired,\n  orgUnitDetails: PropTypes.object.isRequired,\n  inProgress: PropTypes.bool.isRequired\n};\n\nAddEditOrgUnits.defaultProps = {};\n\nconst mapStateToProps = state => {\n  return {\n    errorCode: state.addEditOrgUnitReducerStore.errorCode,\n    orgUnitDetails: state.listReducerStore[STORE.ORG_UNITS_DETAILS],\n    inProgress: state.addEditOrgUnitReducerStore.inProgress\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    submit: (type, data) => {\n      dispatch(getActionsFormate(type, data));\n    },\n    resetState: type => {\n      dispatch(getActionsFormate(type));\n    },\n    getOrgUnitDetails: (type, data) => {\n      dispatch(getActionsFormate(type, data));\n    }\n  };\n};\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(AddEditOrgUnits)\n);\n"]},"metadata":{},"sourceType":"module"}